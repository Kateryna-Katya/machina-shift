{"version":3,"file":"index.js","sources":["../src/main.js"],"sourcesContent":["document.addEventListener('DOMContentLoaded', () => {\n    console.log('DOM Loaded. Initializing Machina Shift...');\n\n    // 1. ICONS (Lucide)\n    // Оборачиваем в try-catch\n    try {\n        if (typeof lucide !== 'undefined') {\n            lucide.createIcons();\n        } else {\n            console.warn('Lucide icons library not loaded');\n        }\n    } catch (e) {\n        console.error('Icons Error:', e);\n    }\n\n    // 2. MOBILE MENU (Logic isolated)\n    initMobileMenu();\n\n    // 3. SMOOTH SCROLL (Lenis)\n    initSmoothScroll();\n\n    // 4. HERO ANIMATION (Three.js)\n    initHeroAnimation();\n});\n\n/* =========================================\n   FUNCTION: MOBILE MENU\n   ========================================= */\nfunction initMobileMenu() {\n    try {\n        const burger = document.querySelector('.header__burger');\n        const closeBtn = document.querySelector('.mobile-menu__close');\n        const mobileMenu = document.querySelector('.mobile-menu');\n        const mobileLinks = document.querySelectorAll('.mobile-menu__link, .mobile-menu__btn');\n\n        if (!burger || !mobileMenu) {\n            console.warn('Mobile menu elements not found in HTML');\n            return;\n        }\n\n        const toggleMenu = () => {\n            mobileMenu.classList.toggle('is-open');\n            document.body.style.overflow = mobileMenu.classList.contains('is-open') ? 'hidden' : '';\n        };\n\n        burger.addEventListener('click', (e) => {\n            e.stopPropagation(); // Предотвращаем всплытие\n            toggleMenu();\n        });\n\n        if (closeBtn) {\n            closeBtn.addEventListener('click', toggleMenu);\n        }\n\n        mobileLinks.forEach(link => {\n            link.addEventListener('click', toggleMenu);\n        });\n\n    } catch (e) {\n        console.error('Mobile Menu Error:', e);\n    }\n}\n\n/* =========================================\n   FUNCTION: SMOOTH SCROLL\n   ========================================= */\nfunction initSmoothScroll() {\n    try {\n        if (typeof Lenis === 'undefined') return;\n\n        const lenis = new Lenis({\n            duration: 1.2,\n            easing: (t) => Math.min(1, 1.001 - Math.pow(2, -10 * t)),\n            smooth: true,\n        });\n\n        function raf(time) {\n            lenis.raf(time);\n            requestAnimationFrame(raf);\n        }\n        requestAnimationFrame(raf);\n    } catch (e) {\n        console.error('Lenis Error:', e);\n    }\n}\n\n/* =========================================\n   FUNCTION: HERO ANIMATION (Three.js)\n   ========================================= */\nfunction initHeroAnimation() {\n    const container = document.getElementById('canvas-container');\n    \n    // Проверки безопасности\n    if (!container) return;\n    if (typeof THREE === 'undefined') {\n        console.error('Three.js library is not loaded!');\n        return;\n    }\n\n    try {\n        const scene = new THREE.Scene();\n        const camera = new THREE.OrthographicCamera(-1, 1, 1, -1, 0, 1);\n        const renderer = new THREE.WebGLRenderer({ alpha: true, antialias: true });\n        \n        renderer.setSize(window.innerWidth, window.innerHeight);\n        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2)); // Оптимизация для ретины\n        container.appendChild(renderer.domElement);\n\n        // Texture Loading with CORS fix\n        const loader = new THREE.TextureLoader();\n        loader.setCrossOrigin('anonymous'); // ВАЖНО для загрузки картинок с других сайтов\n        \n        // Используем более надежный источник картинки или заглушку, если картинка не грузится\n        // Попробуем простую абстракцию, если picsum заблокирован политиками браузера\n        const imgUrl = 'https://images.unsplash.com/photo-1550684848-fac1c5b4e853?q=80&w=2070&auto=format&fit=crop';\n        \n        const texture = loader.load(imgUrl, \n            () => { console.log('Texture loaded successfully'); },\n            undefined,\n            (err) => { console.error('Texture load error:', err); }\n        );\n\n        const mouse = new THREE.Vector2(0, 0);\n        const targetMouse = new THREE.Vector2(0, 0);\n\n        const uniforms = {\n            uTime: { value: 0 },\n            uTexture: { value: texture },\n            uMouse: { value: mouse },\n            uResolution: { value: new THREE.Vector2(window.innerWidth, window.innerHeight) },\n            uHover: { value: 0 }\n        };\n\n        const material = new THREE.ShaderMaterial({\n            uniforms: uniforms,\n            vertexShader: `\n                varying vec2 vUv;\n                void main() {\n                    vUv = uv;\n                    gl_Position = vec4(position, 1.0);\n                }\n            `,\n            fragmentShader: `\n                uniform float uTime;\n                uniform sampler2D uTexture;\n                uniform vec2 uMouse;\n                uniform vec2 uResolution;\n                varying vec2 vUv;\n\n                void main() {\n                    vec2 uv = vUv;\n                    float aspect = uResolution.x / uResolution.y;\n                    \n                    vec2 mousePoint = uMouse;\n                    mousePoint.x *= aspect;\n                    \n                    vec2 uvAspect = uv;\n                    uvAspect.x *= aspect;\n                    \n                    float dist = distance(uvAspect, mousePoint);\n                    \n                    // Liquid Distortion Logic\n                    float influence = smoothstep(0.4, 0.0, dist);\n                    \n                    uv.x += influence * (uv.x - uMouse.x) * 0.15; // Increased strength\n                    uv.y += influence * (uv.y - uMouse.y) * 0.15;\n\n                    vec4 color = texture2D(uTexture, uv);\n                    \n                    // Darken image slightly to make text readable\n                    color.rgb *= 0.4; \n                    \n                    // Acid Green Tint based on movement\n                    color.rgb += vec3(influence * 0.2, influence * 0.4, 0.0);\n\n                    gl_FragColor = color;\n                }\n            `\n        });\n\n        const geometry = new THREE.PlaneGeometry(2, 2);\n        const plane = new THREE.Mesh(geometry, material);\n        scene.add(plane);\n\n        // Event Listeners\n        document.addEventListener('mousemove', (e) => {\n            targetMouse.x = e.clientX / window.innerWidth;\n            targetMouse.y = 1.0 - (e.clientY / window.innerHeight);\n        });\n\n        window.addEventListener('resize', () => {\n            const width = window.innerWidth;\n            const height = window.innerHeight;\n            renderer.setSize(width, height);\n            uniforms.uResolution.value.x = width;\n            uniforms.uResolution.value.y = height;\n        });\n\n        // Animation Loop\n        const clock = new THREE.Clock();\n        function animate() {\n            requestAnimationFrame(animate);\n            \n            const elapsedTime = clock.getElapsedTime();\n            uniforms.uTime.value = elapsedTime;\n\n            // Smooth mouse\n            mouse.x += (targetMouse.x - mouse.x) * 0.08;\n            mouse.y += (targetMouse.y - mouse.y) * 0.08;\n\n            renderer.render(scene, camera);\n        }\n        animate();\n\n    } catch (e) {\n        console.error('Three.js Logic Error:', e);\n    }\n}"],"names":["e","initMobileMenu","initSmoothScroll","initHeroAnimation","burger","closeBtn","mobileMenu","mobileLinks","toggleMenu","link","raf","time","lenis","t","container","animate","elapsedTime","clock","uniforms","mouse","targetMouse","renderer","scene","camera","loader","texture","err","material","geometry","plane","width","height"],"mappings":"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"}